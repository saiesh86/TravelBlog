SET TERM ^ ;
ALTER PROCEDURE MP_SITES_INSERT (
    SITEGUID Char(36),
    SITENAME Varchar(255),
    SKIN Varchar(100),
    LOGO Varchar(50),
    ICON Varchar(50),
    ALLOWUSERSKINS Smallint,
    ALLOWPAGESKINS Smallint,
    ALLOWHIDEMENUONPAGES Smallint,
    ALLOWNEWREGISTRATION Smallint,
    USESECUREREGISTRATION Smallint,
    USESSLONALLPAGES Smallint,
    DEFAULTPAGEKEYWORDS Varchar(255),
    DEFAULTPAGEDESCRIPTION Varchar(255),
    DEFAULTPAGEENCODING Varchar(255),
    DEFAULTADDITIONALMETATAGS Varchar(255),
    ISSERVERADMINSITE Smallint,
    USELDAPAUTH Smallint,
    AUTOCREATELDAPUSERONFIRSTLOGIN Smallint,
    LDAPSERVER Varchar(255),
    LDAPPORT Integer,
    LDAPDOMAIN Varchar(255),
    LDAPROOTDN Varchar(255),
    LDAPUSERDNKEY Varchar(10),
    REALLYDELETEUSERS Smallint,
    USEEMAILFORLOGIN Smallint,
    ALLOWUSERFULLNAMECHANGE Smallint,
    EDITORSKIN Varchar(50),
    DEFAULTFRIENDLYURLPATTERNENUM Varchar(50),
    ALLOWPASSWORDRETRIEVAL Smallint,
    ALLOWPASSWORDRESET Smallint,
    REQUIRESQUESTIONANDANSWER Smallint,
    MAXINVALIDPASSWORDATTEMPTS Integer,
    PASSWORDATTEMPTWINDOWMINUTES Integer,
    REQUIRESUNIQUEEMAIL Smallint,
    PASSWORDFORMAT Integer,
    MINREQUIREDPASSWORDLENGTH Integer,
    MINREQNONALPHACHARS Integer,
    PWDSTRENGTHREGEX Blob sub_type 1,
    DEFAULTEMAILFROMADDRESS Varchar(100),
    ENABLEMYPAGEFEATURE Smallint,
    EDITORPROVIDER Varchar(255) ,
    DATEPICKERPROVIDER Varchar(255),
    CAPTCHAPROVIDER Varchar(255) ,
    RECAPTCHAPRIVATEKEY Varchar(255) ,
    RECAPTCHAPUBLICKEY Varchar(255) ,
    WORDPRESSAPIKEY Varchar(255) ,
    WINDOWSLIVEAPPID Varchar(255) ,
    WINDOWSLIVEKEY Varchar(255) ,
    ALLOWOPENIDAUTH Smallint,
    ALLOWWINDOWSLIVEAUTH Smallint
)
RETURNS (
    SITEID Integer )
AS
BEGIN
 SITEID = NEXT VALUE FOR mp_Sites_seq;

INSERT INTO 	MP_SITES
(				
                SITEID,
                SITEGUID,
                SITENAME,
                SKIN,
                LOGO,
                ICON,
                ALLOWUSERSKINS,
                ALLOWPAGESKINS,
                ALLOWHIDEMENUONPAGES,
                ALLOWNEWREGISTRATION,
                USESECUREREGISTRATION,
                USESSLONALLPAGES,
                DEFAULTPAGEKEYWORDS,
                DEFAULTPAGEDESCRIPTION,
                DEFAULTPAGEENCODING,
                DEFAULTADDITIONALMETATAGS,
                ISSERVERADMINSITE,
                USELDAPAUTH,
                AUTOCREATELDAPUSERONFIRSTLOGIN,
                LDAPSERVER,
                LDAPPORT,
                LDAPDOMAIN,
                LDAPROOTDN,
                LDAPUSERDNKEY,
                REALLYDELETEUSERS,
                USEEMAILFORLOGIN,
                ALLOWUSERFULLNAMECHANGE,
                EDITORSKIN,
                DEFAULTFRIENDLYURLPATTERNENUM,
                ALLOWPASSWORDRETRIEVAL,
                ALLOWPASSWORDRESET,
                REQUIRESQUESTIONANDANSWER,
                MAXINVALIDPASSWORDATTEMPTS,
                PASSWORDATTEMPTWINDOWMINUTES,
                REQUIRESUNIQUEEMAIL,
                PASSWORDFORMAT,
                MINREQUIREDPASSWORDLENGTH,
                MINREQNONALPHACHARS,
                PWDSTRENGTHREGEX,
                DEFAULTEMAILFROMADDRESS,
                ENABLEMYPAGEFEATURE,
                EDITORPROVIDER,
                DATEPICKERPROVIDER,
                CAPTCHAPROVIDER,
                RECAPTCHAPRIVATEKEY,
                RECAPTCHAPUBLICKEY,
                WORDPRESSAPIKEY,
                WINDOWSLIVEAPPID,
                WINDOWSLIVEKEY,
                ALLOWOPENIDAUTH,
                ALLOWWINDOWSLIVEAUTH
) 
VALUES 
(				
               :SITEID,
               :SITEGUID,
               :SITENAME,
               :SKIN,
               :LOGO,
               :ICON,
               :ALLOWUSERSKINS,
               :ALLOWPAGESKINS,
               :ALLOWHIDEMENUONPAGES,
               :ALLOWNEWREGISTRATION,
               :USESECUREREGISTRATION,
               :USESSLONALLPAGES,
               :DEFAULTPAGEKEYWORDS,
               :DEFAULTPAGEDESCRIPTION,
               :DEFAULTPAGEENCODING,
               :DEFAULTADDITIONALMETATAGS,
               :ISSERVERADMINSITE,
               :USELDAPAUTH,
               :AUTOCREATELDAPUSERONFIRSTLOGIN,
               :LDAPSERVER,
               :LDAPPORT,
               :LDAPDOMAIN,
               :LDAPROOTDN,
               :LDAPUSERDNKEY,
               :REALLYDELETEUSERS,
               :USEEMAILFORLOGIN,
               :ALLOWUSERFULLNAMECHANGE,
               :EDITORSKIN,
               :DEFAULTFRIENDLYURLPATTERNENUM,
               :ALLOWPASSWORDRETRIEVAL,
               :ALLOWPASSWORDRESET,
               :REQUIRESQUESTIONANDANSWER,
               :MAXINVALIDPASSWORDATTEMPTS,
               :PASSWORDATTEMPTWINDOWMINUTES,
               :REQUIRESUNIQUEEMAIL,
               :PASSWORDFORMAT,
               :MINREQUIREDPASSWORDLENGTH,
               :MINREQNONALPHACHARS,
               :PWDSTRENGTHREGEX,
               :DEFAULTEMAILFROMADDRESS,
               :ENABLEMYPAGEFEATURE,
               :EDITORPROVIDER,
                :DATEPICKERPROVIDER,
                :CAPTCHAPROVIDER,
                :RECAPTCHAPRIVATEKEY,
                :RECAPTCHAPUBLICKEY,
                :WORDPRESSAPIKEY,
                :WINDOWSLIVEAPPID,
                :WINDOWSLIVEKEY,
                :ALLOWOPENIDAUTH,
                :ALLOWWINDOWSLIVEAUTH
);

END^
SET TERM ; ^
